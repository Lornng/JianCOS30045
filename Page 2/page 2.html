<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>ASIA.csv Bar Chart</title>
</head>
<body>
    <h1>Top 10 Bar Chart</h1>
    <div>
        <button id="button2020">2020</button>
        <button id="button2015">2015</button>
        <button id="button2010">2010</button>
    </div>
    <svg></svg>
    <script src="https://d3js.org/d3.v5.min.js"></script>
   <script>
    // Margin, width, and height
    var margin = { top: 20, right: 20, bottom: 50, left: 60 };
    var width = 960 - margin.left - margin.right;
    var height = 480 - margin.top - margin.bottom;

    // Load data from ASIA.csv
    d3.csv("ASIA.csv").then(function(data) {
        var dataset = data;
        var activeColumn = "2020"; // Initially set to "2020"

        // Define X Scale
        var xScale = d3.scaleBand()
            .domain(dataset.map(function(d) { return d.Countries; }))
            .range([0, width])
            .padding(0.1);

        // Define Y Scale
        var yScale = d3.scaleLinear()
            .domain([0, d3.max(dataset, function(d) { return +d["2020"]; })])
            .range([height, 0])
            .nice();

        // Create an SVG element and set its attributes
        var svg = d3.select("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // Draw the bars
        var bars = svg.selectAll("rect")
            .data(dataset)
            .enter()
            .append("rect")
            .attr("x", function(d) { return xScale(d.Countries); })
            .attr("y", function(d) { return yScale(+d[activeColumn]); })
            .attr("width", xScale.bandwidth())
            .attr("height", function(d) { return height - yScale(+d[activeColumn]); })
            .attr("fill", "steelblue");

        // Add text labels to the bars
        var labels = svg.selectAll(".bar-label")
            .data(dataset)
            .enter()
            .append("text")
            .attr("class", "bar-label")
            .attr("x", function(d) { return xScale(d.Countries) + xScale.bandwidth() / 2; })
            .attr("y", function(d) { return yScale(+d[activeColumn]) - 5; })
            .attr("text-anchor", "middle")
            .text(function(d) { return d[activeColumn]; });

        // Add x-axis to the chart
        var xAxis = d3.axisBottom(xScale);
        svg.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis);

        // Add y-axis to the chart
        var yAxis = d3.axisLeft(yScale);
        svg.append("g")
            .call(yAxis);

        // Button event listeners
        d3.select("#button2020").on("click", function() {
            activeColumn = "2020";
            updateChart();
        });

        d3.select("#button2015").on("click", function() {
            activeColumn = "2015";
            updateChart();
        });

        d3.select("#button2010").on("click", function() {
            activeColumn = "2010";
            updateChart();
        });

        // Function to update the chart based on the active column
        function updateChart() {
            var max2020 = d3.max(dataset, function(d) { return +d["2020"]; });
            var maxActive = d3.max(dataset, function(d) { return +
            d[activeColumn]; });
            var maxYValue = Math.max(max2020, maxActive);

            yScale.domain([0, maxYValue]).nice();

            bars.transition()
                .duration(500)
                .attr("y", function(d) { return yScale(+d[activeColumn]); })
                .attr("height", function(d) { return height - yScale(+d[activeColumn]); });

            labels.transition()
                .duration(500)
                .attr("y", function(d) { return yScale(+d[activeColumn]) - 5; })
                .text(function(d) { return d[activeColumn]; });
        }
    });
</script>

</body>
</html>
